# 합성 데이터 고도화 계획 (물리 기반 정교화)

**목표**: 실제 크랙 데이터 확보 전까지, 가능한 최대한 정교하고 사실에 가까운 물리학 기반 합성 데이터 생성

**최종 업데이트**: 2026년 2월 18일

## 현재 합성 데이터 현황

### 구현된 기능
- **시나리오**: `normal`, `crack`, `pre_damage`, `thick_panel`, `uv_overcured`
- **물리 모델**: 1D 빔 근사, 곡률 분포, 변형률 근사
- **시간적 진행**: drive signal, damping, response_alpha

### 개선 필요 영역
1. **크랙 발생 시점의 물리적 현상 모델링**
   - 충격파(shockwave) 패턴
   - 미세 진동(micro-vibration)
   - 에너지 방출 및 감쇠

2. **시계열 패턴의 현실성 향상**
   - 프레임 간 연속성 강화
   - 노이즈 모델 개선 (측정 노이즈 vs 물리적 변동)

3. **다양한 크랙 패턴 생성**
   - 크랙 발생 시점 다양화
   - 크랙 강도/크기 다양화
   - 부분 크랙 (완전 파괴 전 단계)

---

## 개선 계획

### 1. 크랙 발생 시점 물리 현상 모델링

#### 1.1 충격파(Shockwave) 패턴 추가
**물리적 배경**: 크랙 발생 시 급격한 에너지 방출로 인한 충격파 전파

**상태**: ✅ 구현 완료 (`src/motionanalyzer/synthetic.py`)

**구현 내용 요약**:
- 크랙 발생 프레임에서 가속도 스파이크 모델링
- 지수 감쇠 함수로 충격파 효과 감쇠
- 검증 스크립트: `scripts/validate_enhanced_synthetic.py`

**파라미터**:
- `shockwave_amplitude`: 충격파 진폭
- `shockwave_decay_rate`: 감쇠율
- `shockwave_propagation_speed`: 전파 속도

#### 1.2 미세 진동(Micro-vibration) 패턴 추가
**물리적 배경**: 크랙 발생 후 구조적 불안정으로 인한 미세 진동

**상태**: ✅ 구현 완료 (`src/motionanalyzer/synthetic.py`)

**구현 내용 요약**:
- 감쇠 진동(damped oscillation) 모델로 크랙 이후 미세 진동 시그니처 추가
- 검증 스크립트: `scripts/validate_enhanced_synthetic.py`

**파라미터**:
- `vibration_frequency`: 진동 주파수 (Hz)
- `vibration_damping`: 진동 감쇠 계수
- `vibration_duration`: 진동 지속 시간 (프레임)

#### 1.3 에너지 방출 및 감쇠 모델
**물리적 배경**: 크랙 발생 시 탄성 변형 에너지의 급격한 방출

**구현 방안**:
- 크랙 발생 전후 에너지 밸런스 계산
- 방출된 에너지가 속도/가속도 변화로 전환
- 시간에 따른 에너지 감쇠

### 2. 시계열 패턴 현실성 향상

#### 2.1 프레임 간 연속성 강화
**현재 문제**: 프레임 간 급격한 변화 가능성

**개선 방안**:
- 프레임 간 보간(interpolation) 강화
- 속도/가속도 제한 (물리적으로 가능한 범위)
- 부드러운 전이(smooth transition) 보장

#### 2.2 노이즈 모델 개선
**현재**: 단순 Gaussian 노이즈

**개선 방안**:
- 측정 노이즈 vs 물리적 변동 분리
- 색깔 있는 노이즈(colored noise) 모델 (자기상관 고려)
- 시나리오별 노이즈 특성 차별화

### 2.3 “검증용 특징셋” 규정 (라벨 누설 방지)

ML(DREAM/PatchCore)로 precision-recall을 검증할 때는, Physics 산출물인 `crack_risk`, `crack_risk_*`를 특징에서 제외한다.

- 이유: `crack_risk_*`는 이미 Physics 기반 판정 점수이므로 ML 입력으로 포함 시 성능이 과대평가될 수 있다.
- 정책: 합성 데이터 개선 시에는 “physics-derived 제외” 특징셋 기준으로 ROC AUC + PR AUC를 함께 보고, 개선 전/후를 비교한다.

### 3. 다양한 크랙 패턴 생성

#### 3.1 크랙 발생 시점 다양화
**현재**: 고정된 `crack_center_ratio`

**개선 방안**:
- 크랙 발생 시점을 확률 분포로 모델링
- 조기 크랙 vs 후기 크랙 시나리오
- 다중 크랙 발생 시나리오

#### 3.2 크랙 강도/크기 다양화
**현재**: 고정된 `crack_gain`

**개선 방안**:
- 크랙 강도 분포 (경미한 크랙 ~ 심각한 크랙)
- 크랙 크기(영향 범위) 다양화
- 점진적 크랙 확장 모델

#### 3.3 부분 크랙 (Pre-damage 강화)
**현재**: `pre_damage` 시나리오 존재하나 단순

**개선 방안**:
- 부분 크랙의 점진적 진행 모델
- 미세 균열 → 확장 → 완전 파괴 단계 모델링
- 각 단계별 특징 패턴 정의

---

## 구현 단계

### Phase 1: 기본 물리 현상 추가 (1주)
- [x] 충격파 패턴 추가
- [x] 미세 진동 패턴 추가
- [x] 기본 테스트 및 검증 (`scripts/validate_enhanced_synthetic.py`)

### Phase 2: 시계열 현실성 향상 (1주)
- [ ] 프레임 간 연속성 강화
- [ ] 노이즈 모델 개선
- [ ] 검증: 시계열 패턴 분석

### Phase 3: 크랙 패턴 다양화 (1주)
- [ ] 크랙 발생 시점 다양화
- [ ] 크랙 강도/크기 다양화
- [ ] 부분 크랙 모델 강화

### Phase 4: 통합 검증 (3-5일)
- [ ] 모든 시나리오 통합 테스트
- [ ] DREAM/PatchCore 모델 재검증
- [ ] Change Point Detection 재검증
- [ ] 성능 비교 (개선 전 vs 후)

---

## 검증 기준

### 물리적 현실성
- [ ] 크랙 발생 시 가속도 스파이크 관찰 가능
- [ ] 충격파 전파 패턴 확인
- [ ] 미세 진동 패턴 확인
- [ ] 에너지 보존 법칙 준수 (근사)

### 시계열 패턴
- [ ] 프레임 간 연속성 확인
- [ ] 물리적으로 가능한 속도/가속도 범위 준수
- [ ] 노이즈 특성이 시나리오별로 차별화

### ML 모델 성능
- [ ] DREAM 모델 성능 유지 또는 향상
- [ ] PatchCore 모델 성능 유지 또는 향상
- [ ] Change Point Detection 정확도 향상

---

## 참고 문헌

- **충격파 모델링**: 고체 역학, 파열 역학
- **진동 모델링**: 구조 동역학, 감쇠 진동
- **에너지 방출**: 파괴 역학, 탄성 변형 에너지
